// datable.js by invot
// version 0.1.2

function toObject(t,e){for(var n={},a=0;a<t.length;a++)n[t[a]]=e[a];return n}String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var n=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>n.length)&&(e=n.length),e-=t.length;var a=n.indexOf(t,e);return-1!==a&&a===e}),function(t){t.fn.datable=function(){t(this).each(function(){var e=t(this).attr("data-datable"),n=e.match(/.{2}/g),a=[],r=t(this).attr("data-datable-divider"),h=r?r:" / ";t.each(n,function(e,n){-1===t.inArray(n,a)?a.push(n):(a.pop(),a.push(n+n))});var i=a.join(h).toUpperCase();t(this).attr("maxlength",i.length),t(this).attr("placeholder",i).val(),t(this).on("keydown",function(e){(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&-1===t.inArray(e.keyCode,[46,8,9,27,13,110,190])&&e.preventDefault(),8==e.keyCode?t(this).val().endsWith(h)&&(t(this).val(t(this).val().replace(new RegExp(h+"$"),"")),e.preventDefault()):t(this).val().length!==i.length&&(t(this).val().length==a[0].length?t(this).val(t(this).val()+h):t(this).val().length==a[0].length+a[1].length+h.length&&t(this).val(t(this).val()+h))}),t(this).on("blur",function(){var e=t(this).val().split(h),n=toObject(a,e),r=0;(n.mm>12||n.mm<1)&&r++,(n.dd>31||n.dd<1)&&r++,(n.yyyy>3e3||n.yyyy<1e3)&&r++,0!==t(this).val().length&&r?t(this).addClass("error").closest(".control-group").addClass("has-error"):t(this).removeClass("error").closest(".control-group").removeClass("has-error")})})}}(jQuery);
